{
  "rules": {
    "isConnected": {
      ".read": true,
      ".write": false
    },
    "appInfo": {
      ".read": true,
      ".write": false
    },
    "admin": {
      "ids": {
        ".read": false,
        ".write": false
      },
      "tester": {
        ".read": " root.child('admin/ids').hasChild(auth.uid)",
        ".write": " root.child('admin/ids').hasChild(auth.uid)"
      }
    },
    "questions": {
      ".read": "  root.child('admin/ids').hasChild(auth.uid)",
      ".write": " root.child('admin/ids').hasChild(auth.uid)"
    },
    "answers": {
      ".read": "  root.child('admin/ids').hasChild(auth.uid)",
      ".write": " root.child('admin/ids').hasChild(auth.uid)"
    },
    "users": {
      ".read": "  root.child('admin/ids').hasChild(auth.uid)",
      ".write": " root.child('admin/ids').hasChild(auth.uid)"
    },
    "v0_1_0": {
      ".write": "root.child('admin/ids').hasChild(auth.uid)",
      "questions": {
        "$uid": {
          ".read": "  auth.uid !== null",
          ".write": " auth.uid === $uid || root.child('admin/ids').hasChild(auth.uid)"
        }
      },
      "answers": {
        "$token": {
          ".read": "                         auth.uid === root.child('v0_1_0/tokens/' + $token + '/metadata/createdBy').val() || root.child('admin/ids').hasChild(auth.uid)",
          "$uid": {
            ".read": "  auth.uid === $uid || auth.uid === root.child('v0_1_0/tokens/' + $token + '/metadata/createdBy').val() || root.child('admin/ids').hasChild(auth.uid)",
            ".write": " auth.uid === $uid || auth.uid === root.child('v0_1_0/tokens/' + $token + '/metadata/createdBy').val() || root.child('admin/ids').hasChild(auth.uid)"
          }
        }
      },
      "users": {
        "$uid": {
          ".read": " auth.uid === $uid || root.child('v0_1_0/users/' + $uid + '/tokens/userWithExtendedPermissions').hasChild(auth.uid) || root.child('admin/ids').hasChild(auth.uid)",
          ".write": "auth.uid === $uid || root.child('admin/ids').hasChild(auth.uid)",
          "tokens": {
            "connected": {
              ".write": "auth.uid === $uid || (root.child('v0_1_0/users/' + $uid + '/tokens/userWithExtendedPermissions').hasChild(auth.uid) && !newData.exists()) || root.child('admin/ids').hasChild(auth.uid)"
            },
            "userWithExtendedPermissions": {
              ".write": "auth.uid === $uid || (root.child('v0_1_0/users/' + $uid + '/tokens/userWithExtendedPermissions').hasChild(auth.uid) && !newData.exists()) || root.child('admin/ids').hasChild(auth.uid)"
            }
          }
        }
      },
      "tokens": {
        "existing": {
          ".read": "   auth.uid !== null",
          "$token": {
            ".write": "auth.uid === root.child('v0_1_0/tokens/' + $token + '/metadata/createdBy').val() || root.child('admin/ids').hasChild(auth.uid)"
          }
        },
        "$token": {
          ".write": "                         auth.uid === root.child('v0_1_0/tokens/' + $token + '/metadata/createdBy').val() || root.child('admin/ids').hasChild(auth.uid)",
          "connectedUsers": {
            ".read": "                        auth.uid === root.child('v0_1_0/tokens/' + $token + '/metadata/createdBy').val() || root.child('admin/ids').hasChild(auth.uid)",
            "$uid": {
              ".write": "auth.uid === $uid || auth.uid === root.child('v0_1_0/tokens/' + $token + '/metadata/createdBy').val() || root.child('admin/ids').hasChild(auth.uid)"
            }
          },
          "metadata": {
            ".read": " auth.uid !== null",
            ".write": "auth.uid === newData.child('createdBy').val() || root.child('admin/ids').hasChild(auth.uid)"
          }
        }
      }
    }
  }
}